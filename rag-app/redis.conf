# Redis Configuration for Railway $5 Plan (300MB RAM)

# Memory Management - CRITICAL FOR $5 PLAN
# Set max memory to 250MB (leaving 50MB for Redis overhead)
maxmemory 250mb

# Eviction Policy - Remove least recently used keys when memory is full
# This prevents Redis from crashing when memory limit is reached
maxmemory-policy allkeys-lru

# Persistence Settings - Disable to save memory
# AOF is already disabled in Railway env vars
save ""

# Connection Settings
timeout 300
tcp-keepalive 60
tcp-backlog 511

# Performance Tuning for Limited Resources
databases 1
hz 10

# Disable expensive operations
stop-writes-on-bgsave-error no
rdbcompression no
rdbchecksum no

# Client output buffer limits
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit replica 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60

# Logging
loglevel warning

# Memory Optimization
lazyfree-lazy-eviction yes
lazyfree-lazy-expire yes
lazyfree-lazy-server-del yes
replica-lazy-flush yes